<!DOCTYPE HTML>
<html>
	<head>
		<title>test</title>
		<script src="/public/js/jquery-1.8.3.js"></script>
		<script src="/public/js/mustache.js"></script>
		<script>
			var browseDir = function(dir) {
				var template = 
					"<p>Dir listing for {{dir}}</p>"+
					"<ul>"+
					"{{#parentdir}}<li><a onclick='browseDir(\"{{parentdir}}\")'>..</a>{{/parentdir}}"+
					"{{#entries}}"+
						"<li><span style='color:blue'>{{type}}</span> <a onclick='"+
							"browseDir(\"{{path}}\")"+
						"'>{{name}}</a> <a href='/serve/{{path}}'>serve</a></li>"+
					"{{/entries}}"+
					"</ul>";

				var url = "/list/" + dir;

				$.ajax("/list/"+dir, {
					async:		true,
					cache:		false,
					dataType:	"json",
					success:	function(data, status, xhr) {
									document.body.innerHTML = Mustache.to_html(template, data);
								}
					});					
			};
			$(document).ready(function() {
				browseDir("/");
			});
		</script>
	</head>
	<body>
	</body>
</html>
