<!DOCTYPE HTML>
<html>
	<head>
		<title>test</title>
		<style>
			a:hover {
				cursor:pointer;
			}
		</style>
		<script src="/public/js/jquery-1.8.3.js"></script>
		<script src="/public/js/mustache.js"></script>
		<script>
			var template;
			var browseDir = function(dir) {
				/*var template = 
					"<p>Dir listing for {{dir}}</p>"+
					"<ul>"+
					"{{#parentdir}}<li><a onclick='browseDir(\"{{parentdir}}\")'>..</a>{{/parentdir}}"+
					"{{#entries}}"+
						"<li><span style='color:blue'>{{type}}</span> <a onclick='"+
							"browseDir(\"{{path}}\")"+
						"'>{{name}}</a> <a href='/serve/{{path}}'>serve</a></li>"+
					"{{/entries}}"+
					"</ul>";
				template =
					"<p>Directory {{dir}}</p>"+
					"<table width='100%' border='0' cellspacing='0'>"+
					"{{#parentdir}}<tr><td class=\"col-type\" width=\"40\">dir</td><td class=\"col-name\" width=\"*\"><a onclick=\"browseDir('{{parentdir}}')\">..</a></td></tr>{{/parentdir}}"+
					"{{#entries}}<tr>"+
						"<td class=\"col-type\" width=\"40\">{{type}}</td>"+
						"<td class=\"col-name\" width=\"*\">"+
							"{{#size}}<a href=\"/serve{{path}}\">{{name}}</a>{{/size}}"+
							"{{^size}}<a onclick=\"browseDir('{{path}}')\">{{name}}</a>{{/size}}"+
						"</td></tr>{{/entries}}"+
					"</table>";*/

				var url = "/list/" + dir;

				$.ajax("/list/"+dir, {
					async:		true,
					cache:		false,
					dataType:	"json",
					success:	function(data, status, xhr) {
									document.body.innerHTML = Mustache.to_html(template, data);
								}
					});					
			};
			$(document).ready(function() {
				$.ajax("/public/templates/dirlist.mustache.htm", {
					async:		true,
					cache:		true,
					dataType:	"html",
					success:	function(data, status, xhr) {
									template = data;
									browseDir("/");
								}
					});
			});
		</script>
	</head>
	<body>
	</body>
</html>
